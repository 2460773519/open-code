/*********************************************************************************************************************
* COPYRIGHT NOTICE
* Copyright (c) 2018,逐飞科技
* All rights reserved.
* 技术讨论QQ群：一群：179029047(已满)  二群：244861897
*
* 以下所有内容版权均属逐飞科技所有，未经允许不得用于商业用途，
* 欢迎各位使用并传播本程序，修改内容时必须保留逐飞科技的版权声明。
*
* @file				SEEKFREE_IIC
* @company			成都逐飞科技有限公司
* @author			逐飞科技(QQ3184284598)
* @version			查看doc内version文件 版本说明
* @Software			IAR 8.3 or MDK 5.24
* @Taobao			https://seekfree.taobao.com/
* @date				2020-11-23
* @note
* 					接线定义：
* 					------------------------------------
* 					模块管脚			单片机管脚
* 					SCL					查看SEEKFREE_IIC文件内的SEEKFREE_SCL宏定义
* 					SDA					查看SEEKFREE_IIC文件内的SEEKFREE_SDA宏定义
* 					------------------------------------
********************************************************************************************************************/

#ifndef _SEEKFREE_IIC_h
#define _SEEKFREE_IIC_h

#include "bus_dev.h"
#include "gpio.h"
#include "error.h"
#include "stdbool.h"
#include "types.h"
#include "log.h"


// 软件 IIC 定义
#define IIC_SDA_PIN   GPIO_P03
#define IIC_SCL_PIN   GPIO_P07//p3 p2
#define IN1         GPIO_P34
#define IN2         GPIO_P02

#define SDA		    	hal_gpio_read(IIC_SDA_PIN)
#define SDA0()			hal_gpio_write(IIC_SDA_PIN,0)						// IO口输出低电平
#define SDA1()			hal_gpio_write(IIC_SDA_PIN,1)							// IO口输出高电平
#define SCL0()			hal_gpio_write(IIC_SCL_PIN,0)							// IO口输出低电平
#define SCL1()			hal_gpio_write(IIC_SCL_PIN,1)							// IO口输出高电平
#define DIR_OUT()		hal_gpio_pin_init(IIC_SDA_PIN,OEN)			// 输出方向
#define DIR_IN()		hal_gpio_pin_init(IIC_SDA_PIN,IE); hal_gpio_pull_set(IIC_SDA_PIN, GPIO_PULL_UP)			// 输入方向

#define SEEKFREE_ACK	1															// 主应答
#define SEEKFREE_NACK	0															// 从应答

typedef enum IIC																	// IIC 模块
{
	SIMIIC,
	SCCB
} IIC_type;

void	simiic_delay_set		(uint16 time);
void	simiic_start			(void);
void	simiic_stop				(void);
void	simiic_ack_main			(uint8 ack_main);
void	send_ch					(uint8 c);
uint8	read_ch					(uint8 ack);
void	simiic_write_reg		(uint8 dev_add, uint8 reg, uint8 dat);
void	simiic_write_regs		(uint8 dev_add, uint8 reg, uint8 *dat, uint8 num);
uint8	simiic_read_reg			(uint8 dev_add, uint8 reg, IIC_type type);
void	simiic_read_regs		(uint8 dev_add, uint8 reg, uint8 *dat_add, uint8 num, IIC_type type);
void	simiic_init				(void);
int sccb_waitack(void);
void simiic_sendack(unsigned char ack_dat);
#endif
